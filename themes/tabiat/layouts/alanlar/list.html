{{ define "main" }}
<div class="explore-page">
    <!-- Hero Section -->
    <div class="explore-hero">
        <div class="container">
            <div class="explore-hero-content">
                <h1 class="explore-title">Türkiye'nin Doğal Alanları</h1>
                <p class="explore-subtitle">
                    Türkiye'nin en güzel doğal alanlarını keşfedin. İl, tür veya isimle filtreleyerek arama yapabilirsiniz.
                </p>
            </div>
        </div>
    </div>

    <!-- Breadcrumb -->
    <div class="breadcrumb-section">
        <div class="container">
            <nav class="breadcrumb" aria-label="Breadcrumb">
                <a href="/">
                    <i data-lucide="home" style="width: 16px; height: 16px;"></i>
                    <span>Ana Sayfa</span>
                </a>
                <i data-lucide="chevron-right" style="width: 14px; height: 14px;"></i>
                <span class="current">Tüm Alanlar</span>
            </nav>
        </div>
    </div>

    <!-- Filters Section -->
    <div class="explore-filters-section">
        <div class="container">
            <div class="explore-filters-card">
                <div class="filters-header">
                    <i data-lucide="sliders"></i>
                    <h3>Filtrele ve Keşfet</h3>
                </div>

                <div class="filters-grid">
                    <!-- İl Filtresi -->
                    <div class="filter-item">
                        <label for="provinceFilter">
                            <i data-lucide="map-pin"></i>
                            <span>İl</span>
                        </label>
                        <select id="provinceFilter" class="filter-select">
                            <option value="">Tüm İller</option>
                            {{ $provinces := slice }}
                            {{ range where .Site.RegularPages "Type" "alan" }}
                                {{ if .Params.il }}
                                    {{ $provinces = $provinces | append .Params.il }}
                                {{ end }}
                            {{ end }}
                            {{ range (uniq $provinces | sort) }}
                            <option value="{{ . }}">{{ . }}</option>
                            {{ end }}
                        </select>
                    </div>

                    <!-- Tür Filtresi -->
                    <div class="filter-item">
                        <label for="typeFilter">
                            <i data-lucide="layers"></i>
                            <span>Alan Türü</span>
                        </label>
                        <select id="typeFilter" class="filter-select">
                            <option value="">Tüm Türler</option>
                            <option value="ada">Ada</option>
                            <option value="dag">Dağ</option>
                            <option value="gol">Göl</option>
                            <option value="kanyon">Kanyon</option>
                            <option value="magara">Mağara</option>
                            <option value="milli-park">Milli Park</option>
                            <option value="tabiat-parki">Tabiat Parkı</option>
                            <option value="selale">Şelale</option>
                            <option value="plaj">Plaj</option>
                            <option value="sulak-alan">Sulak Alan</option>
                            <option value="tabiat-aniti">Tabiat Anıtı</option>
                            <option value="jeopark">Jeopark</option>
                            <option value="botanik-bahcesi">Botanik Bahçesi</option>
                            <option value="kayak-merkezi">Kayak Merkezi</option>
                            <option value="kus-cenneti">Kuş Cenneti</option>
                            <option value="orman">Orman</option>
                            <option value="tepe">Tepe</option>
                            <option value="termal-kaynak">Termal Kaynak</option>
                            <option value="vadi">Vadi</option>
                            <option value="yayla">Yayla</option>
                        </select>
                    </div>

                    <!-- Arama -->
                    <div class="filter-item filter-item-search">
                        <label for="searchFilter">
                            <i data-lucide="search"></i>
                            <span>Ara</span>
                        </label>
                        <input type="text" id="searchFilter" class="filter-input" placeholder="Alan adı ile ara...">
                    </div>

                    <!-- Temizle Butonu -->
                    <div class="filter-item filter-item-button">
                        <button id="clearFilters" class="filter-clear-btn">
                            <i data-lucide="x"></i>
                            <span>Temizle</span>
                        </button>
                    </div>
                </div>

                <!-- Sonuç Sayısı -->
                <div id="filterResults" class="filter-results">
                    <i data-lucide="info"></i>
                    <span id="resultCount">{{ len (where .Site.RegularPages "Type" "alan") }}</span> alan bulundu
                </div>
            </div>
        </div>
    </div>

    <!-- Areas Grid -->
    <div class="explore-content">
        <div class="container">
            {{ $areas := where .Site.RegularPages "Type" "alan" }}
            {{ $paginator := .Paginate $areas }}

            <div id="areasGrid" class="areas-grid">
                {{ range $paginator.Pages }}
                <a href="{{ .Permalink }}"
                   class="area-card"
                   data-province="{{ .Params.il }}"
                   data-type="{{ .Params.alan_turu }}"
                   data-name="{{ .Title }}">
                    {{ if .Params.images.hero.url }}
                    <div class="area-card-image">
                        <img src="{{ .Params.images.hero.url }}" alt="{{ .Title }}" loading="lazy">
                        <div class="area-card-overlay">
                            <span class="area-card-type">
                                {{ .Params.alan_turu | humanize }}
                            </span>
                        </div>
                    </div>
                    {{ else }}
                    <div class="area-card-image area-card-placeholder">
                        <i data-lucide="image" style="width: 48px; height: 48px;"></i>
                    </div>
                    {{ end }}
                    <div class="area-card-content">
                        <h3 class="area-card-title">{{ .Title }}</h3>
                        <p class="area-card-location">
                            <i data-lucide="map-pin"></i>
                            {{ .Params.il }}{{ if .Params.ilce }}, {{ .Params.ilce }}{{ end }}
                        </p>
                        {{ if .Description }}
                        <p class="area-card-desc">{{ .Description | truncate 100 }}</p>
                        {{ end }}
                    </div>
                </a>
                {{ end }}
            </div>

            <!-- Pagination -->
            {{ if gt $paginator.TotalPages 1 }}
            <nav class="pagination">
                {{ if $paginator.HasPrev }}
                <a href="{{ $paginator.Prev.URL }}" class="pagination-btn pagination-prev">
                    <i data-lucide="chevron-left"></i>
                    <span>Önceki</span>
                </a>
                {{ end }}

                <div class="pagination-numbers">
                    {{ $currentPage := $paginator.PageNumber }}
                    {{ $totalPages := $paginator.TotalPages }}

                    {{/* İlk sayfa */}}
                    {{ if gt $currentPage 3 }}
                        <a href="{{ $paginator.First.URL }}" class="pagination-number">1</a>
                        {{ if gt $currentPage 4 }}
                            <span class="pagination-ellipsis">...</span>
                        {{ end }}
                    {{ end }}

                    {{/* Mevcut sayfanın çevresindeki sayfalar */}}
                    {{ range $paginator.Pagers }}
                        {{ if and (ge .PageNumber (sub $currentPage 2)) (le .PageNumber (add $currentPage 2)) }}
                            <a href="{{ .URL }}" class="pagination-number {{ if eq .PageNumber $currentPage }}active{{ end }}">
                                {{ .PageNumber }}
                            </a>
                        {{ end }}
                    {{ end }}

                    {{/* Son sayfa */}}
                    {{ if lt $currentPage (sub $totalPages 2) }}
                        {{ if lt $currentPage (sub $totalPages 3) }}
                            <span class="pagination-ellipsis">...</span>
                        {{ end }}
                        <a href="{{ $paginator.Last.URL }}" class="pagination-number">{{ $totalPages }}</a>
                    {{ end }}
                </div>

                {{ if $paginator.HasNext }}
                <a href="{{ $paginator.Next.URL }}" class="pagination-btn pagination-next">
                    <span>Sonraki</span>
                    <i data-lucide="chevron-right"></i>
                </a>
                {{ end }}
            </nav>
            {{ end }}
        </div>
    </div>
</div>

<!-- Filter Script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const provinceFilter = document.getElementById('provinceFilter');
    const typeFilter = document.getElementById('typeFilter');
    const searchFilter = document.getElementById('searchFilter');
    const clearBtn = document.getElementById('clearFilters');
    const cards = document.querySelectorAll('.area-card');
    const resultCount = document.getElementById('resultCount');

    function normalizeText(text) {
        const turkishMap = {
            'ç': 'c', 'ğ': 'g', 'ı': 'i', 'ö': 'o', 'ş': 's', 'ü': 'u',
            'Ç': 'c', 'Ğ': 'g', 'İ': 'i', 'Ö': 'o', 'Ş': 's', 'Ü': 'u'
        };
        return text.toLowerCase().split('').map(char => turkishMap[char] || char).join('');
    }

    function applyFilters() {
        const province = provinceFilter.value;
        const type = typeFilter.value;
        const search = normalizeText(searchFilter.value);
        let visibleCount = 0;

        cards.forEach(card => {
            const cardProvince = card.dataset.province || '';
            const cardType = card.dataset.type || '';
            const cardName = normalizeText(card.dataset.name || '');

            const matchProvince = !province || cardProvince === province;
            const matchType = !type || cardType === type;
            const matchSearch = !search || cardName.includes(search);

            if (matchProvince && matchType && matchSearch) {
                card.style.display = '';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        resultCount.textContent = visibleCount;
    }

    provinceFilter.addEventListener('change', applyFilters);
    typeFilter.addEventListener('change', applyFilters);
    searchFilter.addEventListener('input', applyFilters);

    clearBtn.addEventListener('click', function() {
        provinceFilter.value = '';
        typeFilter.value = '';
        searchFilter.value = '';
        applyFilters();
    });
});
</script>
{{ end }}
